- hosts: wuqing-hostname
  remote_user: '{{ remote_user }}'
  become: yes
  become_user: root
  become_method: sudo
  tasks:
    - debug: var=ansible_default_ipv4.address
    - debug: var=ansible_hostname

    - name: Create workspace directory
      file:
        path: '{{ workspace }}'
        state: directory

    - name: Copy check script to remote server
      copy:
        src: '{{ workspace }}/lotus-ops/scripts/hostnameP1.sh'
        dest: '{{ workspace }}'
        owner: '{{ remote_user }}'
        group: '{{ remote_user }}'
        mode: +x

    - name: Worker pre check
      shell: '{{ workspace }}/hostnameP1.sh'
      register: check_result

    - name: Echo check result
      debug:
        msg: '{{ check_result.stdout }}'
